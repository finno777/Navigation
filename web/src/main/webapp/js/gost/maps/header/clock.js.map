/* This file is generated — do not edit by hand! */
/* eslint-disable */
{"version":3,"sources":["header/clock.js"],"names":["pad","num","width","numAsString","padLength","length","Array","join","TimeSync","correction","serverUrl","headerConstants","cr","sync","setInterval","headers","Accept","$","ajax","dataType","type","url","success","Date","data","currentTime","document","querySelector","TimeRenderer","timeSync","hourEl","minutesEl","secondsEl","mSecondsEl","dateEl","dayEl","daysOfWeek","months","updateCalendar","serverTime","updateClock","removeClass","now","textContent","computeDateString","getDay","innerHTML","getHours","getMinutes","getSeconds","getMilliseconds","date","day","getDate","month","getMonth","year","getFullYear","renderer","init"],"mappings":"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","file":"../../header/clock.js","sourcesContent":["/* global $, headerConstants */\r\n\r\nfunction pad(num, width) {\r\n    const numAsString = `${num}`;\r\n    const padLength = (width - numAsString.length) + 1;\r\n    return numAsString.length >= width ? numAsString : new Array(padLength).join('0') + numAsString;\r\n}\r\n\r\nclass TimeSync {\r\n    constructor() {\r\n        this.correction = 0;\r\n        this.serverUrl = `${headerConstants.cr}/commons/getTime.action`;\r\n\r\n        this.sync();\r\n        setInterval(() => {\r\n            this.sync();\r\n        }, 30 * 1000);\r\n    }\r\n\r\n    sync() {\r\n        const headers = {\r\n            Accept: 'application/json',\r\n            'Content-Type': 'application/json',\r\n        };\r\n\r\n        $.ajax({\r\n            dataType: 'json',\r\n            headers,\r\n            type: 'GET',\r\n            url: this.serverUrl,\r\n            success: data => {\r\n                this.correction = new Date() - new Date(data.currentTime);\r\n            },\r\n        });\r\n    }\r\n\r\n    get serverTime() {\r\n        return new Date(new Date() - this.correction);\r\n    }\r\n}\r\n\r\nif (document.querySelector('[data-clock=\"date\"]') !== null) {\r\n    class TimeRenderer {\r\n        constructor() {\r\n            this.timeSync = new TimeSync();\r\n            this.hourEl = document.querySelector('[data-clock=\"h\"]');\r\n            this.minutesEl = document.querySelector('[data-clock=\"m\"]');\r\n            this.secondsEl = document.querySelector('[data-clock=\"s\"]');\r\n            this.mSecondsEl = document.querySelector('[data-clock=\"ms\"]');\r\n\r\n            this.dateEl = document.querySelector('[data-clock=\"date\"]');\r\n            this.dayEl = document.querySelector('[data-clock=\"dayOfWeek\"]');\r\n\r\n            this.daysOfWeek = [\r\n                'Воскресенье',\r\n                'Понедельник',\r\n                'Вторник',\r\n                'Среда',\r\n                'Четверг',\r\n                'Пятница',\r\n                'Суббота',\r\n            ];\r\n\r\n            this.months = [\r\n                'января',\r\n                'февраля',\r\n                'марта',\r\n                'апреля',\r\n                'мая',\r\n                'июня',\r\n                'июля',\r\n                'августа',\r\n                'сентября',\r\n                'октября',\r\n                'ноября',\r\n                'декабря',\r\n            ];\r\n        }\r\n\r\n        init() {\r\n            this.updateCalendar(this.timeSync.serverTime);\r\n            setInterval(() => this.updateClock(this.timeSync.serverTime), 20);\r\n            setInterval(() => this.updateCalendar(this.timeSync.serverTime), 1000);\r\n            $('.datetime.uninitialized').removeClass('uninitialized');\r\n        }\r\n\r\n        updateCalendar(now) {\r\n            this.dateEl.textContent = this.computeDateString(now);\r\n            this.dayEl.textContent = this.daysOfWeek[now.getDay()];\r\n        }\r\n\r\n        updateClock(now) {\r\n            this.hourEl.innerHTML = pad(now.getHours(), 2);\r\n            this.minutesEl.innerHTML = pad(now.getMinutes(), 2);\r\n            this.secondsEl.innerHTML = pad(now.getSeconds(), 2);\r\n            this.mSecondsEl.innerHTML = pad(now.getMilliseconds(), 3);\r\n        }\r\n\r\n        computeDateString(date) {\r\n            const day = date.getDate();\r\n            const month = this.months[date.getMonth()];\r\n            const year = date.getFullYear();\r\n\r\n            return `${day} ${month} ${year}`;\r\n        }\r\n    }\r\n\r\n    const renderer = new TimeRenderer();\r\n    renderer.init();\r\n}\r\n"]}