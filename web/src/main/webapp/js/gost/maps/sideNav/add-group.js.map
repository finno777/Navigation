/* This file is generated — do not edit by hand! */
/* eslint-disable */
{"version":3,"sources":["sideNav/add-group.js"],"names":["SideNavAddGroup","$elem","that","$linksContainer","find","$groupName","sideNav","window","closest","attr","gostValidation","linkTemplate","addGroupPages","savedGroup","initAddGroup","pages","concat","group","renderAddGroup","val","name","forEach","page","nodeId","displayName","removeClass","prop","setAllValid","html","length","$template","$","clone","text","append","fillGroupInfo","trim","filter","id","validateGroupInfo","selector","requiredFilled","validateRequiredValues","groupInfo","suitableLengths","validateValuesLength","isValid","scrollToFirstError","addGroup","newGroup","groups","map","g","push","some","oldPage","settings","render","dialog","init","fn","fnSideNavAddGroup","each","index","elem"],"mappings":";;AAAA;AACA;AACA;AACA;AACA,CAAC,YAAM;AACH,aAASA,eAAT,CAAyBC,KAAzB,EAAgC;AAC5B,aAAKA,KAAL,GAAaA,KAAb;;AAEA,YAAMC,OAAO,IAAb;AACA,YAAMC,kBAAkBF,MAAMG,IAAN,CAAW,6BAAX,CAAxB;AACA,YAAMC,aAAaJ,MAAMG,IAAN,CAAW,eAAX,CAAnB;AACA,YAAME,UAAUC,mBAAiBN,MAAMO,OAAN,CAAc,cAAd,EAA8BC,IAA9B,CAAmC,YAAnC,CAAjB,CAAhB;AACA,YAAMC,iBAAiBH,OAAOG,cAA9B;AACA,YAAMC,eAAe,4JAArB;AACA,YAAIC,gBAAgB,EAApB;AACA,YAAIC,aAAa,IAAjB;;AAEA,YAAMC,eAAe,SAAfA,YAAe,QAAS;AAC1BF,4BAAgBN,QAAQS,KAAR,CAAcC,MAAd,CAAqBC,QAAQA,MAAMF,KAAd,GAAsB,EAA3C,CAAhB;;AAEA,gBAAIE,KAAJ,EAAW;AACPJ,6BAAaI,KAAb;AACH,aAFD,MAEO;AACHJ,6BAAa,IAAb;AACH;;AAEDK;;AAEA,gBAAID,KAAJ,EAAW;AACPZ,2BAAWc,GAAX,CAAeN,WAAWO,IAA1B;AACA,oBAAIP,WAAWE,KAAf,EAAsB;AAClBF,+BAAWE,KAAX,CAAiBM,OAAjB,CAAyB,gBAAQ;AAC7BnB,6BAAKD,KAAL,CAAWG,IAAX,oCAAiDkB,KAAKC,MAAtD,SAAgED,KAAKE,WAArE,SAAsFhB,OAAtF,CAA8F,kBAA9F,EAAkHiB,WAAlH,CAA8H,MAA9H;AACAvB,6BAAKD,KAAL,CAAWG,IAAX,oCAAiDkB,KAAKC,MAAtD,SAAgED,KAAKE,WAArE,SAAsFE,IAAtF,CAA2F,SAA3F,EAAsG,IAAtG;AACH,qBAHD;AAIH;AACJ,aARD,MAQO;AACHrB,2BAAWc,GAAX,CAAe,EAAf;AACH;AACDT,2BAAeiB,WAAf;AACH,SAvBD;;AAyBA,YAAMT,iBAAiB,SAAjBA,cAAiB,GAAM;AACzBf,4BAAgByB,IAAhB,CAAqB,EAArB;;AAEA,gBAAIhB,cAAciB,MAAlB,EAA0B;AACtBjB,8BAAcS,OAAd,CAAsB,gBAAQ;AAC1B,wBAAMS,YAAYC,EAAEpB,YAAF,EAAgBqB,KAAhB,EAAlB;;AAEAF,8BAAU1B,IAAV,CAAe,6BAAf,EAA8C6B,IAA9C,CAAmDX,KAAKE,WAAxD;AACAM,8BAAU1B,IAAV,CAAe,wBAAf,EAAyCe,GAAzC,CAAgDG,KAAKC,MAArD,SAA+DD,KAAKE,WAApE;AACArB,oCAAgB+B,MAAhB,CAAuBJ,SAAvB;AACH,iBAND;AAOH,aARD,MAQO;AACH3B,gCAAgB+B,MAAhB,CAAuB,wEAAvB;AACH;AACJ,SAdD;;AAgBA,YAAMC,gBAAgB,SAAhBA,aAAgB,GAAM;AACxB,gBAAMf,OAAOf,WAAWc,GAAX,GAAiBiB,IAAjB,EAAb;AACA,gBAAMrB,QAAQH,cAAcyB,MAAd,CAAqB;AAAA,uBAC/BnC,KAAKD,KAAL,CAAWG,IAAX,oCAAiDkB,KAAKC,MAAtD,SAAgED,KAAKE,WAArE,SAAsFE,IAAtF,CAA2F,SAA3F,CAD+B;AAAA,aAArB,CAAd;;AAGA,mBAAO;AACHY,oBAAIzB,aAAaA,WAAWyB,EAAxB,GAA6B,IAD9B;AAEHlB,0BAFG;AAGHL;AAHG,aAAP;AAKH,SAVD;;AAYA,YAAMwB,oBAAoB,SAApBA,iBAAoB,YAAa;AACnC,gBAAMC,+BAA6BtC,KAAKD,KAAL,CAAWO,OAAX,CAAmB,cAAnB,EAAmCC,IAAnC,CAAwC,YAAxC,CAA7B,2BAAN;AACA,gBAAMgC,iBAAiB/B,eAAegC,sBAAf,CAAsCC,SAAtC,EAAiDH,QAAjD,CAAvB;AACA,gBAAMI,kBAAkBlC,eAAemC,oBAAf,CAAoCF,SAApC,EAA+CH,QAA/C,CAAxB;AACA,gBAAMM,UAAUL,kBAAkBG,eAAlC;;AAEA,gBAAI,CAACE,OAAL,EAAc;AACVpC,+BAAeqC,kBAAf;AACH;AACD,mBAAOD,OAAP;AACH,SAVD;;AAYA,YAAME,WAAW,SAAXA,QAAW,GAAM;AACnB,gBAAMC,WAAWd,eAAjB;AACA,gBAAMW,UAAUP,kBAAkBU,QAAlB,CAAhB;;AAEA,gBAAIH,OAAJ,EAAa;AACT,oBAAIjC,UAAJ,EAAgB;AACZP,4BAAQ4C,MAAR,GAAiB5C,QAAQ4C,MAAR,CAAeC,GAAf,CAAmB,aAAK;AACrC,4BAAIC,MAAMvC,UAAV,EAAsB,OAAOuC,CAAP;AACtB,+BAAOH,QAAP;AACH,qBAHgB,CAAjB;AAIH,iBALD,MAKO;AACH3C,4BAAQ4C,MAAR,CAAeG,IAAf,CAAoBJ,QAApB;AACH;;AAED3C,wBAAQS,KAAR,GAAgBH,cAAcI,MAAd,CAAqB,EAArB,EAAyBqB,MAAzB,CAAgC;AAAA,2BAC5C,CAACY,SAASlC,KAAT,CAAeuC,IAAf,CAAoB;AAAA,+BAAQhC,SAASiC,OAAjB;AAAA,qBAApB,CAD2C;AAAA,iBAAhC,CAAhB;;AAGAjD,wBAAQkD,QAAR,CAAiBC,MAAjB;AACAvD,qBAAKD,KAAL,CAAWyD,MAAX,CAAkB,OAAlB;AACH;AACJ,SApBD;;AAsBA,aAAKC,IAAL,GAAY,YAAM;AACdrD,oBAAQ0C,QAAR,GAAmB;AACfW,sBAAM7C,YADS;AAEf2C,wBAAQvC,cAFO;AAGf8B;AAHe,aAAnB;AAKH,SAND;;AAQA,aAAKW,IAAL;AACH;;AAED5B,MAAE6B,EAAF,CAAKC,iBAAL,GAAyB,YAAY;AACjC9B,UAAE,IAAF,EAAQ+B,IAAR,CAAa,UAACC,KAAD,EAAQC,IAAR,EAAiB;AAC1B,gBAAIhE,eAAJ,CAAoB+B,EAAEiC,IAAF,CAApB;AACH,SAFD;AAGH,KAJD;;AAMAjC,MAAE,cAAF,EAAkB+B,IAAlB,CAAuB,YAAY;AAC/B,YAAI,CAACvD,mBAAiBwB,EAAE,IAAF,EAAQtB,IAAR,CAAa,YAAb,CAAjB,CAAL,EAAqD;;AAErDsB,UAAE,IAAF,EAAQ3B,IAAR,CAAa,qBAAb,EAAoCyD,iBAApC;AACH,KAJD;AAKH,CA1HD","file":"../../sideNav/add-group.js","sourcesContent":["/* global $ */\r\n/* eslint no-use-before-define: 0 */\r\n/* eslint no-new: 0 */\r\n/* eslint no-shadow: 0 */\r\n(() => {\r\n    function SideNavAddGroup($elem) {\r\n        this.$elem = $elem;\r\n\r\n        const that = this;\r\n        const $linksContainer = $elem.find('.add-group__links-container');\r\n        const $groupName = $elem.find('.js-groupName');\r\n        const sideNav = window[`sideNav${$elem.closest('[data-appId]').attr('data-appId')}`];\r\n        const gostValidation = window.gostValidation;\r\n        const linkTemplate = '<li class=\"add-group__link\"><label class=\"add-group__link-label checkbox\"><input class=\"add-group__link-input\" type=\"checkbox\"/><span></span></label></li>';\r\n        let addGroupPages = [];\r\n        let savedGroup = null;\r\n\r\n        const initAddGroup = group => {\r\n            addGroupPages = sideNav.pages.concat(group ? group.pages : []);\r\n\r\n            if (group) {\r\n                savedGroup = group;\r\n            } else {\r\n                savedGroup = null;\r\n            }\r\n\r\n            renderAddGroup();\r\n\r\n            if (group) {\r\n                $groupName.val(savedGroup.name);\r\n                if (savedGroup.pages) {\r\n                    savedGroup.pages.forEach(page => {\r\n                        that.$elem.find(`.add-group__link-input[value=\"${page.nodeId}-${page.displayName}\"]`).closest('.add-group__link').removeClass('hide');\r\n                        that.$elem.find(`.add-group__link-input[value=\"${page.nodeId}-${page.displayName}\"]`).prop('checked', true);\r\n                    });\r\n                }\r\n            } else {\r\n                $groupName.val('');\r\n            }\r\n            gostValidation.setAllValid();\r\n        };\r\n\r\n        const renderAddGroup = () => {\r\n            $linksContainer.html('');\r\n\r\n            if (addGroupPages.length) {\r\n                addGroupPages.forEach(page => {\r\n                    const $template = $(linkTemplate).clone();\r\n\r\n                    $template.find('.add-group__link-label span').text(page.displayName);\r\n                    $template.find('.add-group__link-input').val(`${page.nodeId}-${page.displayName}`);\r\n                    $linksContainer.append($template);\r\n                });\r\n            } else {\r\n                $linksContainer.append('<li class=\"add-group__links-empty-mssg\">Нет ссылок для добавления</li>');\r\n            }\r\n        };\r\n\r\n        const fillGroupInfo = () => {\r\n            const name = $groupName.val().trim();\r\n            const pages = addGroupPages.filter(page =>\r\n                that.$elem.find(`.add-group__link-input[value=\"${page.nodeId}-${page.displayName}\"]`).prop('checked'));\r\n\r\n            return {\r\n                id: savedGroup ? savedGroup.id : null,\r\n                name,\r\n                pages,\r\n            };\r\n        };\r\n\r\n        const validateGroupInfo = groupInfo => {\r\n            const selector = `[data-appId = \"${that.$elem.closest('[data-appId]').attr('data-appId')}\"] .js-sideNavAddGroup`;\r\n            const requiredFilled = gostValidation.validateRequiredValues(groupInfo, selector);\r\n            const suitableLengths = gostValidation.validateValuesLength(groupInfo, selector);\r\n            const isValid = requiredFilled && suitableLengths;\r\n\r\n            if (!isValid) {\r\n                gostValidation.scrollToFirstError();\r\n            }\r\n            return isValid;\r\n        };\r\n\r\n        const addGroup = () => {\r\n            const newGroup = fillGroupInfo();\r\n            const isValid = validateGroupInfo(newGroup);\r\n\r\n            if (isValid) {\r\n                if (savedGroup) {\r\n                    sideNav.groups = sideNav.groups.map(g => {\r\n                        if (g !== savedGroup) return g;\r\n                        return newGroup;\r\n                    });\r\n                } else {\r\n                    sideNav.groups.push(newGroup);\r\n                }\r\n\r\n                sideNav.pages = addGroupPages.concat([]).filter(oldPage =>\r\n                    !newGroup.pages.some(page => page === oldPage));\r\n\r\n                sideNav.settings.render();\r\n                that.$elem.dialog('close');\r\n            }\r\n        };\r\n\r\n        this.init = () => {\r\n            sideNav.addGroup = {\r\n                init: initAddGroup,\r\n                render: renderAddGroup,\r\n                addGroup,\r\n            };\r\n        };\r\n\r\n        this.init();\r\n    }\r\n\r\n    $.fn.fnSideNavAddGroup = function () {\r\n        $(this).each((index, elem) => {\r\n            new SideNavAddGroup($(elem));\r\n        });\r\n    };\r\n\r\n    $('[data-appId]').each(function () {\r\n        if (!window[`sideNav${$(this).attr('data-appId')}`]) return;\r\n\r\n        $(this).find('.js-sideNavAddGroup').fnSideNavAddGroup();\r\n    });\r\n})();\r\n"]}